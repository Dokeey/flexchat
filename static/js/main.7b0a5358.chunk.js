(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{151:function(e,t,a){e.exports=a.p+"static/media/flexchatlogo.ad21ba20.png"},163:function(e,t,a){e.exports=a(284)},206:function(e,t,a){},268:function(e,t,a){},269:function(e,t,a){},283:function(e,t,a){},284:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),l=a.n(c),o=a(40),i=a(23),s=a(48),u=a.n(s);function m(e,t){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return console.error(n),t}}function d(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(a){console.error(a)}}var p=Object(n.createContext)(),E=function(e,t){var a=t.type;if(a===h){var n=t.payload,r=t.pk,c=Object(i.a)(Object(i.a)({},e),{},{jwtToken:n,pk:r});return Object(s.UpdateWithSideEffect)(c,(function(e,t){d("jwtToken",n)}))}if(a===g){var l=Object(i.a)(Object(i.a)({},e),{},{jwtToken:""});return Object(s.UpdateWithSideEffect)(l,(function(e,t){d("jwtToken","")}))}if(a===v){var o=t.payload,u=Object(i.a)(Object(i.a)({},e),{},{group:o});return Object(s.Update)(u)}if(a===y){var m=Object(i.a)(Object(i.a)({},e),{},{group:""});return Object(s.Update)(m)}if(a===k){var p=t.payload,E=Object(i.a)(Object(i.a)({},e),{},{total_user:p});return Object(s.Update)(E)}if(a===O){var f=t.payload,b=Object(i.a)(Object(i.a)({},e),{},{is_match:f});return Object(s.Update)(b)}if(a===S){var w=t.payload,N=Object(i.a)(Object(i.a)({},e),{},{is_login:w});return Object(s.Update)(N)}if(a===j){var T=t.payload,_=Object(i.a)(Object(i.a)({},e),{},{userSocket:T});return Object(s.Update)(_)}if(a===x){var P=t.payload,A=Object(i.a)(Object(i.a)({},e),{},{waiterSocket:P});return Object(s.Update)(A)}return e},f=function(e){var t=e.children,a=m("jwtToken",""),n=u()(E,{jwtToken:a,pk:-1,group:"",total_user:"Loading...",is_match:!1,is_loing:!1,userSocket:"",waiterSocket:""}),c=Object(o.a)(n,2),l=c[0],i=c[1];return r.a.createElement(p.Provider,{value:{store:l,dispatch:i}},t)},b=function(){return Object(n.useContext)(p)},h="APP/SET_TOKEN",g="APP/DELETE_TOKEN",v="APP/SET_GROUP",y="APP/DELETE_GROUP",k="APP/SET_TOTALUSER",O="APP/SET_ISMATCH",S="APP/SET_ISLOGIN",j="APP/SET_USERSOCKET",x="APP/SET_WAITERSOCKET",w=function(){return{type:y}},N=function(e){return{type:O,payload:e}},T=function(e){return{type:S,payload:e}},_=function(e){return{type:j,payload:e}},P=function(e){return{type:x,payload:e}},A=a(104),C=a(33),U=a(161),I=a(311),z=a(60),J=a.n(z),W=a(85),B=a(289),L=a(294),R=a(142),G="https://dry-dawn-35150.herokuapp.com",F="wss://dry-dawn-35150.herokuapp.com",D=a.n(R).a.create({baseURL:G});function K(e){var t=e.chatClose,a=e.setWaiters,n=b(),c=n.store,l=c.pk,o=c.jwtToken,i=c.userSocket,s=c.waiterSocket,u=n.dispatch,m={Authorization:"JWT ".concat(o)},d=function(){var e=Object(W.a)(J.a.mark((function e(){var n,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(),o){e.next=4;break}return u(T(!1)),e.abrupt("return",null);case 4:return u(N(!0)),s&&s.send(JSON.stringify({})),e.prev=6,e.next=9,D.get("/chat/match/".concat(l,"/"),{headers:m});case 9:(n=e.sent).data.group?i.send(JSON.stringify({group:n.data.group})):((r=new WebSocket(F+"/ws/waiter/?token=".concat(o))).onmessage=function(e){var t=JSON.parse(e.data);a(t.waiters_count)},u(P(r))),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(B.a,{type:"primary",shape:"round",onClick:d,size:"large",style:{border:"2px solid white"}},r.a.createElement(L.a,null),"\xa0\ucc44\ud305\uc2dc\uc791"))}var M=a(147),q=a.n(M),H=a(295),V=a(296),Q=a(297),X=a(298),Y=a(299),Z=a(300),$=a(291),ee=a(285);a(206);function te(e){var t=e.chatSocket,a=e.setChatSocket,c=b(),l=c.store,i=l.group,s=l.pk,u=l.is_match,m=l.waiterSocket,d=c.dispatch,p=Object(n.useState)(""),E=Object(o.a)(p,2),f=E[0],h=E[1],g=Object(n.useState)(0),v=Object(o.a)(g,2),y=v[0],k=v[1],O=Object(n.useState)(0),S=Object(o.a)(O,2),j=S[0],x=S[1],T=Object(n.useRef)(null),_=Object(n.useState)([]),P=Object(o.a)(_,2),A=P[0],C=P[1];m&&(m.onmessage=function(e){var t=JSON.parse(e.data);x(t.waiters_count)}),t.onmessage=function(e){var t=JSON.parse(e.data);s===t.pk?(A.push(r.a.createElement("div",{key:y,className:"bubble"},t.message)),C(A)):("M"===t.gender?A.push(r.a.createElement("div",{key:y,className:"another"},r.a.createElement("div",{className:"another-user"},r.a.createElement($.a,{icon:r.a.createElement(H.a,null),style:{marginLeft:"10px",backgroundColor:"skyblue"}}),r.a.createElement("div",{className:"another-bubble"},t.message)))):A.push(r.a.createElement("div",{key:y,className:"another"},r.a.createElement("div",{className:"another-user"},r.a.createElement($.a,{icon:r.a.createElement(V.a,null),style:{marginLeft:"10px",backgroundColor:"hotpink"}}),r.a.createElement("div",{className:"another-bubble"},t.message)))),C(A)),k((function(e){return e+1}))},t.onclose=function(e){C([r.a.createElement("div",{key:"0",ref:T})]),d(w()),a({}),d(N(!1)),U.a.open({message:"\ucc44\ud305\uc774 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",description:"\uc0c8\ub85c\uc6b4 \ucc44\ud305\uc744 \uc2dc\uc791\ud558\uc138\uc694",icon:r.a.createElement(Q.a,{style:{color:"red"}})})};return Object(n.useEffect)((function(){document.querySelector(".chat-log-window").scrollTop=document.querySelector(".chat-log-window").scrollHeight}),[y]),r.a.createElement("div",{className:"chat-content"},r.a.createElement("div",{className:"chat-log-window"},u?i?A:r.a.createElement("div",{className:"flex-center"},r.a.createElement(ee.a,{size:"large",tip:j?r.a.createElement("div",null,"\ub0b4 \uc55e\uc758 \ub300\uae30\uc790 \uc218 : ",j):r.a.createElement("span",null,"\uc7a0\uc2dc\ud6c4 \ub9e4\uce6d\ub429\ub2c8\ub2e4!"),style:{color:"white"},indicator:r.a.createElement(X.a,{style:{fontSize:36},spin:!0})})):r.a.createElement("div",{className:"flex-center"},r.a.createElement(K,{chatClose:function(){if(!t.close)return null;t.close()},setWaiters:x}))),r.a.createElement("div",null,r.a.createElement(q.a,{placeholder:i?"\uba54\uc138\uc9c0\ub97c \ubcf4\ub0b4\uc138\uc694!":"\ucc44\ud305\uc2dc\uc791 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694!",enterButton:r.a.createElement(Y.a,null),prefix:r.a.createElement(Z.a,null),size:"large",value:f,disabled:!i,allowClear:!0,maxLength:"100",onChange:function(e){return h(e.target.value)},onSearch:function(){if(!f)return null;t.send(JSON.stringify({message:f})),h("")}})))}var ae=a(287);function ne(){var e=b(),t=e.store,a=t.total_user,c=t.userSocket,l=e.dispatch,o=function(e){var t,a=JSON.parse(e.data);l(function(e){return{type:k,payload:e}}(a.user_count)),l((t=a.group,{type:v,payload:t}))};return Object(n.useEffect)((function(){var e=new WebSocket(F+"/ws/users/");e.onmessage=function(e){o(e)},l(_(e))}),[]),c&&(c.onmessage=function(e){o(e)}),r.a.createElement(ae.a,{hoverable:!0,title:r.a.createElement("div",{style:{textAlign:"center",wordBreak:"break-all"}},"\uc9c0\uae08 \uba87\uba85?"),bordered:!0},r.a.createElement("h1",{style:{textAlign:"center",color:"#43d5d2"}},a))}a(268);var re=a(151),ce=a.n(re);function le(e){var t=e.children,a=e.right_sidebar,n=e.user_info,c=e.footer;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:ce.a,alt:"Flex Chat"})),r.a.createElement("div",{className:"topnav"},n)),r.a.createElement("div",{className:"contents"},t),r.a.createElement("div",{className:"left-sidebar"}),r.a.createElement("div",{className:"right-sidebar"},a),r.a.createElement("div",{className:"footer"},c))}var oe=a(301);function ie(e){var t=e.chatSocket,a=b().store.group;return r.a.createElement("div",null,a?r.a.createElement(B.a,{type:"danger",danger:!0,block:!0,shape:"round",icon:r.a.createElement(oe.a,null),size:"large",onClick:function(){if(!t.close)return null;t.close()},style:{marginTop:"10px"}},"\ucc44\ud305 \uadf8\ub9cc\ud558\uae30"):null)}var se=a(292),ue=a(290),me=a(302),de=a(303),pe=a(304),Ee=a(305);function fe(e){e.signal;var t=b(),a=t.store,c=a.jwtToken,l=a.is_login,s=a.userSocket,u=t.dispatch,m=Object(n.useState)({gender:"",want_match:""}),d=Object(o.a)(m,2),p=d[0],E=d[1],f=Object(n.useState)(!1),g=Object(o.a)(f,2),v=g[0],y=g[1],k=Object(n.useState)(!1),O=Object(o.a)(k,2),S=O[0],j=O[1],x=function(){var e=Object(W.a)(J.a.mark((function e(){var t,a,n,l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j(!0),!p.pk){e.next=13;break}return u(N(!1)),t={Authorization:"JWT ".concat(c)},e.next=7,D.put("/accounts/users/".concat(p.pk,"/"),Object(i.a)({},p),{headers:t});case 7:a=e.sent,E(a.data),j(!1),P(),e.next=25;break;case 13:return e.next=15,D.post("/accounts/users/",Object(i.a)({},p));case 15:n=e.sent,E(n.data),u((o=n.data.token,m=n.data.pk,{type:h,payload:o,pk:m})),j(!1),P(),u(T(!0)),s.send(JSON.stringify({})),s.close(4e3),l=new WebSocket(F+"/ws/users/?token=".concat(n.data.token)),u(_(l));case 25:U.a.open({message:"\uc131\uacf5\uc801\uc73c\ub85c \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",description:"\uc774\uc81c \ucc44\ud305\uc744 \uc2dc\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4!",icon:r.a.createElement(me.a,{style:{color:"green"}})}),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.error(e.t0);case 31:case"end":return e.stop()}var o,m}),e,null,[[0,28]])})));return function(){return e.apply(this,arguments)}}(),w=function(){y(!0)},P=function(){y(!1)};return Object(n.useEffect)((function(){l||(w(),u(T(!0)))}),[l,u]),r.a.createElement("div",null,r.a.createElement(r.a.Fragment,null,c?r.a.createElement(de.a,{onClick:w,style:{fontSize:"40px",color:"#43d5d2"}}):r.a.createElement(pe.a,{onClick:w,style:{fontSize:"40px",color:"#43d5d2"}}),r.a.createElement(se.a,{maskStyle:{backgroundColor:"transparent"},placement:"left",closable:!0,onClose:P,visible:v,style:{boxShadow:"0 8px 16px 0 rgba(0, 0, 0, 1)"}},r.a.createElement("div",null,r.a.createElement("p",{style:{marginBottom:24,textAlign:"center"}},r.a.createElement(pe.a,null),"\xa0SETTING"),r.a.createElement("hr",{style:be}),r.a.createElement("div",{style:{marginTop:"30px",fontWeight:"bold",fontSize:"20px",color:"skyblue"}},"\uc800\ub294"),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(ue.a.Group,{onChange:function(e){return E((function(t){return Object(i.a)(Object(i.a)({},t),{},{gender:e.target.value})}))},buttonStyle:"solid",size:"large",style:{margin:"10px 0 10px 0",borderRadius:"12px"}},r.a.createElement(ue.a.Button,{style:he,value:"M"},r.a.createElement(H.a,null),"\xa0\ub0a8\uc790"),r.a.createElement(ue.a.Button,{style:he,value:"F"},r.a.createElement(V.a,null),"\xa0\uc5ec\uc790"))),r.a.createElement("div",{style:{textAlign:"right",marginBottom:"30px"}},"\uc785\ub2c8\ub2e4."),r.a.createElement("hr",{style:be}),r.a.createElement("div",{style:{marginTop:"30px",fontWeight:"bold",fontSize:"20px",color:"hotpink"}},"\uc0c1\ub300\ubc29\uc740 \xa0"),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(ue.a.Group,{onChange:function(e){return E((function(t){return Object(i.a)(Object(i.a)({},t),{},{want_match:e.target.value})}))},buttonStyle:"solid",style:{margin:"10px 0 10px 0",borderRadius:"12px"},size:"large"},r.a.createElement(ue.a.Button,{style:he,value:"M"},r.a.createElement(H.a,null),"\xa0\ub0a8\uc790"),r.a.createElement(ue.a.Button,{style:he,value:"F"},r.a.createElement(V.a,null),"\xa0\uc5ec\uc790"),r.a.createElement(ue.a.Button,{style:he,value:"A"},r.a.createElement(Ee.a,null),"\xa0\uc544\ubb34\ub098"))),r.a.createElement("div",{style:{textAlign:"right",marginBottom:"30px"}},"\uac00 \uc88b\uaca0\uc5b4\uc694."),r.a.createElement("hr",{style:be}),r.a.createElement("div",{style:{textAlign:"center",marginTop:"30px"}},r.a.createElement(B.a,{style:{borderRadius:"8px",boxShadow:"0 2px 4px 0 gray"},block:!0,type:"primary",loading:S,disabled:!p.gender||!p.want_match,size:"large",onClick:x},"\uc800\uc7a5"))))))}var be={borderTop:"1px solid #eaeaea"},he={borderRadius:"8px",border:"2px solid #43d5d2",margin:"3px 3px 0 3px",boxShadow:"0 2px 3px 0 gray"},ge=a(288),ve=a(286),ye=a(293),ke=a(306),Oe=a(307),Se=a(308),je=a(309),xe=a(310),we=(a(269),function(){var e=ge.a.Link;return r.a.createElement("div",{className:"footer-contents"},r.a.createElement("div",{className:"footer-content"},r.a.createElement(ve.a,null,r.a.createElement(ke.a,null),"\xa0Project"),r.a.createElement(ye.a,null,r.a.createElement(ye.a.Item,{dot:r.a.createElement(Oe.a,{className:"timeline-clock-icon",style:{color:"dimgray"}})},r.a.createElement(e,{href:"https://github.com/dokeey/flexchat"},"https://github.com/dokeey/flexchat")),r.a.createElement(ye.a.Item,{dot:r.a.createElement(Se.a,{className:"timeline-clock-icon"}),color:"dimgray"},"\uce5c\uad6c \ubabb \uc0ac\uadc0\uc5b4\ub3c4 \ucc45\uc784 \uc548\uc9d0"))),r.a.createElement("div",{className:"footer-content"},r.a.createElement(ve.a,null,r.a.createElement(je.a,null),"\xa0\uac1c\ubc1c\uc7901"),r.a.createElement(ye.a,null,r.a.createElement(ye.a.Item,{dot:r.a.createElement(xe.a,{className:"timeline-clock-icon",style:{color:"skyblue"}})},r.a.createElement(e,{href:"mailto:ehdngv@naver.com"},"ehdngv@naver.com")),r.a.createElement(ye.a.Item,{dot:r.a.createElement(Oe.a,{className:"timeline-clock-icon",style:{color:"dimgray"}})},r.a.createElement(e,{href:"https://github.com/Dokeey/"},"https://github.com/Dokeey")),r.a.createElement(ye.a.Item,{dot:r.a.createElement(Se.a,{className:"timeline-clock-icon"}),color:"dimgray"},"\uc0bc\uacb9\uc0b4\uc744 \uc88b\uc544\ud568"))),r.a.createElement("div",{className:"footer-content"},r.a.createElement(ve.a,null,r.a.createElement(je.a,null),"\xa0\uac1c\ubc1c\uc7902"),r.a.createElement(ye.a,null,r.a.createElement(ye.a.Item,{dot:r.a.createElement(xe.a,{className:"timeline-clock-icon",style:{color:"skyblue"}})},r.a.createElement(e,{href:"mailto:thflthdi@naver.com"},"thflthdi@naver.com")),r.a.createElement(ye.a.Item,{dot:r.a.createElement(Oe.a,{className:"timeline-clock-icon",style:{color:"dimgray"}})},r.a.createElement(e,{href:"https://github.com/thflthdi/"},"https://github.com/thflthdi")),r.a.createElement(ye.a.Item,{dot:r.a.createElement(Se.a,{className:"timeline-clock-icon"}),color:"dimgray"},"\uac15\uc544\uc9c0\ub97c \ud0a4\uc6c0"))))});var Ne=function(){var e=b().store,t=e.jwtToken,a=e.group,c=e.waiterSocket,l=Object(n.useState)({}),i=Object(o.a)(l,2),s=i[0],u=i[1];Object(n.useEffect)((function(){if(t&&a){var e=new WebSocket(F+"/ws/chat/?token=".concat(t));u(e),c&&c.close(),U.a.open({message:"\uc0c1\ub300\ubc29\uacfc \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",description:"\uc778\uc0ac\ub97c \uac74\ub124\ubcf4\uc138\uc694 :)",icon:r.a.createElement(I.a,{style:{color:"#43d5d2"}})})}}),[t,a]);var m=r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,null),r.a.createElement(ie,{chatSocket:s}));return r.a.createElement("div",null,r.a.createElement(le,{right_sidebar:m,user_info:r.a.createElement(fe,null),footer:r.a.createElement(we,null)},r.a.createElement(te,{chatSocket:s,setChatSocket:u})))},Te=a(55),_e=a.n(Te),Pe=a(160),Ae=function(e){return function(e){void 0===e&&(e=function(){});var t=Object(Pe.a)(e);Object(n.useEffect)((function(){var e=function(e){var a=t.current(e);if(e.defaultPrevented&&(e.returnValue=""),"string"===typeof a)return e.returnValue=a,a};return window.addEventListener("unload",e),function(){window.removeEventListener("unload",e)}}),[t])}(e.onUnload),e.children};Ae.defaultProps={children:null},Ae.propTypes={children:_e.a.any,onUnload:_e.a.func.isRequired};var Ce=function(){var e=b(),t=e.store,a=t.pk,n=t.userSocket,c=t.waiterSocket,l=e.dispatch,o=function(){l({type:g}),l(w());c&&c.close(),n.close();try{navigator.sendBeacon("".concat("https://dry-dawn-35150.herokuapp.com","/accounts/delete/").concat(a,"/"))}catch(e){console.error(e)}};return r.a.createElement(Ae,{onUnload:function(){return o()}},r.a.createElement(C.a,{path:"/",component:Ne}))};a(282),a(283);l.a.render(r.a.createElement(A.a,{basename:""},r.a.createElement(f,null,r.a.createElement(Ce,null))),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.7b0a5358.chunk.js.map